<!-- Generated by documentation.js. Update this documentation by updating the source code. -->

### Table of Contents

-   [ParatiiCore][1]
-   [ParatiiCoreUsers][2]
    -   [create][3]
    -   [get][4]
    -   [update][5]
-   [ParatiiCoreVids][6]
    -   [like][7]
    -   [dislike][8]
    -   [doesLike][9]
    -   [hasViewedVideo][10]
    -   [doesDislike][11]
    -   [create][12]
    -   [update][13]
    -   [upsert][14]
    -   [view][15]
    -   [get][16]
    -   [search][17]
-   [ParatiiDb][18]
-   [ParatiiDbUsers][19]
    -   [get][20]
    -   [videos][21]
-   [ParatiiDbVids][22]
    -   [get][23]
    -   [search][24]
-   [constructor][25]
-   [getTcrContract][26]
-   [getMinDeposit][27]
-   [isWhitelisted][28]
-   [didVideoApply][29]
-   [apply][30]
-   [checkEligiblityAndApply][31]
-   [ParatiiEthUsers][32]
-   [ParatiiIPFS][33]
    -   [add][34]
    -   [get][35]
    -   [log][36]
    -   [warn][37]
    -   [error][38]
    -   [getIPFSInstance][39]
    -   [addJSON][40]
    -   [addAndPinJSON][41]
    -   [getJSON][42]
    -   [start][43]
    -   [stop][44]
-   [Uploader][45]
    -   [add][46]
    -   [html5FileToPull][47]
    -   [fsFileToPull][48]
    -   [upload][49]
    -   [addDirectory][50]
    -   [transcode][51]
    -   [\_transcoderRespHander][52]
    -   [addAndTranscode][53]
-   [Paratii][54]
    -   [setAccount][55]
    -   [setRegistryAddress][56]
    -   [diagnose][57]

## ParatiiCore

Contains functions that operate transversally over several backend systems. <br />
validates the config file and istantiates ParatiiCoreVids and ParatiiCoreUsers.

**Parameters**

-   `config` **[Object][58]** configuration object to initialize Paratii object

## ParatiiCoreUsers

Utilities to create and manipulate information about the users on the blockchain.

**Parameters**

-   `config` **[Object][58]** configuration object to initialize Paratii object

### create

Creates a user, fields id, name and email go to the smart contract Users, other fields are stored on IPFS.

**Parameters**

-   `options` **[Object][58]** information about the video ( id, name, email ... )

**Examples**

```javascript
paratii.core.users.create({
             id: 'some-user-id',
             name: 'A user name',
             email: 'some@email.com',
             ...
            })
```

Returns **[Promise][59]** the id of the newly created user

### get

retrieve data about the user

**Parameters**

-   `id` **[String][60]** user univocal id

**Examples**

```javascript
paratii.core.users.get('some-user-id')
```

Returns **[Object][58]** data about the user

### update

Updates a user's details. name and email are defined in the smart contract Users, other fields get written to IPFS.

**Parameters**

-   `userId` **[String][60]** user univocal id
-   `options` **[Object][58]** updated data i.e. { name: 'A new user name' }

**Examples**

```javascript
paratii.core.users.update('some-user-id', {name: 'A new user name'})
```

Returns **[Promise][59]** updated data about the user

## ParatiiCoreVids

Utilities to create and manipulate information about the videos on the blockchain.

**Parameters**

-   `config` **[Object][58]** configuration object to initialize Paratii object

### like

Writes a like for the video on the blockchain (contract Likes), and negates a dislike for the video, if it exists.

**Parameters**

-   `videoId` **[String][60]** univocal video identifier

**Examples**

```javascript
paratii.core.vids.like('some-video-id')
```

Returns **[Object][58]** information about the transaction recording the like

### dislike

Writes a dislike for the video on the blockchain (contract Likes), and negates a like for the video, if it exists.

**Parameters**

-   `videoId` **[String][60]** univocal video identifier

**Examples**

```javascript
paratii.core.vids.dislike('some-video-id')
```

Returns **[Object][58]** information about the transaction recording the dislike

### doesLike

Check if the current user has already liked the video

**Parameters**

-   `videoId` **[String][60]** univocal video identifier

**Examples**

```javascript
paratii.core.vids.doesLike('some-video-id')
```

Returns **[Boolean][61]** true if the current user already liked the video, false otherwise

### hasViewedVideo

Check if the viewer has already viewed the video

**Parameters**

-   `viewer` **[String][60]** viewer address
-   `videoId` **[String][60]** univocal video identifier

**Examples**

```javascript
paratii.core.vids.hasViewedVideo('some-user-id','some-video-id')
```

Returns **[Boolean][61]** true if the current user already viewed the video, false otherwise

### doesDislike

Check if the current user has already disliked the video

**Parameters**

-   `videoId` **[String][60]** univocal video identifier

**Examples**

```javascript
paratii.core.vids.doesDislike('some-video-id')
```

Returns **[Boolean][61]** true if the current user already disliked the video, false otherwise

### create

This call will register the video on the blockchain, add its metadata to IPFS, upload file to IPFS, and transcode it

**Parameters**

-   `options` **[Object][58]** information about the video ( videoId, title, FilePath ... )

**Examples**

```javascript
paratii.core.vids.create({
 id: 'some-video-id',
 owner: 'some-user-id',
 title: 'some Title',
 author: 'Steven Spielberg',
 duration: '2h 32m',
 description: 'A long description',
 price: 0,
 file: 'test/data/some-file.txt'
})
```

Returns **[Promise][59]** information about the video ( VideoId, owner, ipfsHash ... )

### update

Update the information on the video.
 Only the account that has registered the video, or the owner of the contract, can update the information.

**Parameters**

-   `videoId` **[String][60]** univocal video identifier
-   `options` **[Object][58]** key value pairs of properties and new values e.g. ({title: 'another-title'})
-   `dataToUpdate` **[Object][58]** optional. old data of the video. If not passed to the method, it will fetch the data itself using the videoId

**Examples**

```javascript
paratii.core.vids.update('some-video-id', {title: 'another-title'})
```

Returns **[Promise][59]** Updated video informations

### upsert

Update the information of the video the video already exists, otherwise it creates it

**Parameters**

-   `options` **[Object][58]** video informations

**Examples**

```javascript
paratii.core.vids.upsert({ id: 'some-video-id', owner: 'some-user-id', title: 'videoTitle'}) //insert a new video
```

Returns **[Promise][59]** updated/new video informations

### view

Register a view on the blockchain

**Parameters**

-   `options` **[Object][58]** should contain keys viewer (address of the viewer) and videoId (univocal video identifier)

**Examples**

```javascript
paratii.core.vids.view({viewer:'some-user-id',videoId: 'some-video-id'})
```

Returns **[Promise][59]** information about the transaction recording the view

### get

Get the data of the video identified by videoId

**Parameters**

-   `videoId` **[String][60]** univocal video identifier

**Examples**

```javascript
paratii.core.vids.get('some-video-id')
```

Returns **[Promise][59]** data about the video

### search

Get the data of the video

**Parameters**

-   `options` **[Object][58]** data about the video and (optional) owner i.e {'keyword':'titleOfTheVideo'}

**Examples**

```javascript
paratii.core.vids.search({keyword : 'titleOftheVideo'})
the keyword value can be one from the following list
- video title
- description
- owner
- uploader.name
- uploader.address
- tags
```

Returns **[Promise][59]** data about the video

## ParatiiDb

ParatiiDb contains a functionality to interact with the Paratii Blockchain Index. <br>
validates the config file and istantiates ParatiiDbVids and ParatiiDbUsers.

**Parameters**

-   `config` **[Object][58]** 

## ParatiiDbUsers

ParatiiDbUsers contains functionalities regarding the users to interact with the Paratii Blockchain Index

**Parameters**

-   `config` **[Object][58]** object to initialize Paratii object

### get

retrieve data about the user

**Parameters**

-   `userId` **[String][60]** user univocal id

**Examples**

```javascript
paratii.db.users.get('some-user-id')
```

Returns **[Promise][59]** data about the user

### videos

get information about all the videos of the user

**Parameters**

-   `userId` **[String][60]** univocal user identifier

**Examples**

```javascript
paratii.db.users.videos('some-user-id')
```

Returns **[Promise][59]** Collection of all the videos of the user

## ParatiiDbVids

ParatiiDbUsers contains functionalities regarding the videos to interact with the Paratii Blockchain Index

**Parameters**

-   `config` **[Object][58]** object to initialize Paratii object

### get

Get information about this video from the db

**Parameters**

-   `videoId` **[String][60]** univocal video identifier

**Examples**

```javascript
paratii.db.vids.get('some-video-id')
```

Returns **[Promise][59]** data about the video

### search

Get the data of the video

**Parameters**

-   `options` **[Object][58]** data about the video and (optional) owner i.e {'keyword':'titleOfTheVideo'}

**Examples**

```javascript
paratii.db.vids.search({keyword : 'titleOftheVideo'})
the keyword value can be one from the following list
- video title
- description
- owner
- uploader.name
- uploader.address
- tags
```

Returns **[Promise][59]** data about the video

## constructor

TCR functionality

**Parameters**

-   `context` **[object][58]** ParatiiEth Instance

Returns **TCR** returns instances of Tcr

## getTcrContract

get TCR contract instance.

Returns **[Promise][59]** Contract instance.

## getMinDeposit

get the minimum amount required to stake a video.

Returns **Float** amount required in PTI

## isWhitelisted

check if video is already whitelisted or not. note that this returns false
till the video is actually whitelisted. use didVideoApply in case you want
to check whether the video is in application process.

**Parameters**

-   `videoId` **[string][60]** videoId

Returns **[boolean][61]** is video whitelisted or not.

## didVideoApply

check whether a video started the application process or not yet.

**Parameters**

-   `videoId` **[string][60]** videoId

Returns **[boolean][61]** did the video start the TCR process.

## apply

start the application process.
NOTE that this require the client approves PTI amount first before actually
running this function, use `checkEligiblityAndApply` instead.

**Parameters**

-   `videoId` **[string][60]** videoId
-   `amountToStake` **Float** number of tokens to stake. must >= minDeposit

Returns **[boolean][61]** returns true if all is good, plus \_Application
event.

## checkEligiblityAndApply

check whether the user has enough funds to stake.
it also approves the TCR contract to amountToStake.

**Parameters**

-   `videoId` **\[type]** [description]
-   `amountToStake` **\[type]** [description]

Returns **[Promise][59]** [description]

## ParatiiEthUsers

[eth description]

Type: \[type]

**Parameters**

-   `context`  

## ParatiiIPFS

**Extends EventEmitter**

Contains functions to interact with the IPFS instance.

**Parameters**

-   `config` **[Object][58]** configuration object to initialize Paratii object

### add

Adds the file to ipfs

**Parameters**

-   `fileStream` **ReadStream** ReadStream of the file. Can be created with fs.createReadStream(path)

**Examples**

```javascript
let path = 'test/data/some-file.txt'
let fileStream = fs.createReadStream(path)
let result = await paratiiIPFS.add(fileStream)
```

Returns **[Promise][59]** data about the added file (path,hash,size)

### get

get file from ipfs

**Parameters**

-   `hash` **[String][60]** hash of the file

**Examples**

```javascript
let result = await paratiiIPFS.add(fileStream)
let hash = result[0].hash
let fileContent = await paratiiIPFS.get(hash)
```

Returns **[Promise][59]** the file (path,content)

### log

log messages on the console if verbose is set

**Parameters**

-   `msg` **[String][60]** text to log

**Examples**

```javascript
paratii.ipfs.log("some-text")
```

### warn

log warns on the console if verbose is set

**Parameters**

-   `msg` **[String][60]** warn text

**Examples**

```javascript
paratii.ipfs.warn("some-text")
```

### error

log errors on the console if verbose is set

**Parameters**

-   `msg` **[String][60]** error message

**Examples**

```javascript
paratii.ipfs.error("some-text")
```

### getIPFSInstance

get an ipfs instance of jsipfs. Singleton pattern

**Examples**

```javascript
ipfs = await paratii.ipfs.getIPFSInstance()
```

Returns **[Object][58]** Ipfs instance

### addJSON

adds a data Object to the IPFS local instance

**Parameters**

-   `data` **[Object][58]** JSON object to store

**Examples**

```javascript
let result = await paratiiIPFS.addJSON(data)
```

Returns **[Promise][59]** promise with the ipfs hash

### addAndPinJSON

convenient method to add JSON and send it for persistance storage.

**Parameters**

-   `data` **[object][58]** JSON object to store

**Examples**

```javascript
let result = await paratiiIPFS.addAndPinJSON(data)
```

Returns **[string][60]** returns multihash of the stored object.

### getJSON

gets a JSON object stored in IPFS

**Parameters**

-   `multihash` **[String][60]** ipfs hash of the object

**Examples**

```javascript
let jsonObj = await paratiiIPFS.getJSON('some-hash')
```

Returns **[Promise][59]** requested Object

### start

Starts the IPFS node

**Parameters**

-   `callback` **[Function][62]** callback function

**Examples**

```javascript
?
```

Returns **?** DON'T KNOW?

### stop

Stops the IPFS node.

**Parameters**

-   `callback` **[Function][62]** callback function

**Examples**

```javascript
?
```

Returns **?** DON'T KNOW?

## Uploader

**Extends EventEmitter**

IPFS UPLOADER : Paratii IPFS uploader interface.

**Parameters**

-   `paratiiIPFS` **[Object][58]** 
-   `opts` **[Object][58]** 

### add

uploads a single file to _local_ IPFS node

**Parameters**

-   `file` **File** HTML5 File Object.

Returns **EventEmitter** checkout the upload function below for details.

### html5FileToPull

returns a generic File Object with a Pull Stream from an HTML5 File

**Parameters**

-   `file` **File** HTML5 File Object

Returns **[Object][58]** generic file object.

### fsFileToPull

returns a generic file Object from a file path

**Parameters**

-   `filePath` **[String][60]** Path to file.

Returns **[Object][58]** generic file object.

### upload

upload an Array of files as is to the local IPFS node

**Parameters**

-   `files` **[Array][63]** HTML5 File Object Array.

Returns **EventEmitter** returns EventEmitter with the following events:-   'start': uploader started.
-   'progress': (chunkLength, progressPercent)
-   'fileReady': (file) triggered when a file is uploaded locally.
-   'done': (files) triggered when the uploader is done locally.
-   'error': (err) triggered whenever an error occurs.

### addDirectory

upload an entire directory to IPFS

**Parameters**

-   `dirPath` **[String][60]** path to directory

Returns **[Promise][59]** returns the {hash, path, size} for the uploaded folder.

### transcode

signals transcoder(s) to transcode fileHash

**Parameters**

-   `fileHash` **[String][60]** IPFS file hash.
-   `options` **[Object][58]** ref: [https://github.com/Paratii-Video/paratii-lib/blob/master/docs/paratii-ipfs.md#ipfsuploadertranscodefilehash-options][64]

Returns **EventEmitter** returns EventEmitter with the following events:-   'uploader:progress': (hash, chunkSize, percent) client to transcoder upload progress.
-   'transcoding:started': (hash, author)
-   'transcoding:progress': (hash, size, percent)
-   'transcoding:downsample:ready' (hash, size)
-   'transcoding:done': (hash, transcoderResult) triggered when the transcoder is done - returns the hash of the transcoded file
-   'transcoder:error': (err) triggered whenever an error occurs.

### \_transcoderRespHander

handles responses from the paratii-protocol in case of transcoding.

**Parameters**

-   `ev` **EventEmitter** the transcoding job EventEmitter
-   `fileHash`  

Returns **[function][62]** returns various events based on transcoder response.

### addAndTranscode

convenience method for adding and transcoding files

**Parameters**

-   `files` **[Array][63]** Array of HTML5 File Objects

## Paratii

Paratii library main object
The Paratii object serves as the general entry point for interacting with the family of Paratii
contracts that are deployed on the blockchain, utilities to run and interact with a local IPFS node,
and utilities to interact with the Paratii index.

**Parameters**

-   `opts` **[Object][58]** options object to configure paratii library (optional, default `{}`)
    -   `opts.provider` **[String][60]** optional - the address of an ethereum node (defaults to localhost:8754)
    -   `opts.registryAddress` **[String][60]** optional - the address where the Paratii Contract registry can be found
    -   `opts.address` **[String][60]** optional - address of the operator/user
    -   `opts.privateKey` **[String][60]** optional - private key of the user
    -   `opts.ipfs` **[Object][58]** TODO fix ipfs.repo --> ipfsrepo
        -   `opts.ipfs.repo` **[String][60]** optional - namespace of the ipfs repository
    -   `opts.db` **[Object][58]** TODO fix db.provider --> dbprovider
        -   `opts.db.provider` **[String][60]** optional - baseURL of the mongoDb mirror
    -   `opts.mnemonic` **[String][60]** optional - mnemonic of the user

**Examples**

```javascript
paratii = new Paratii({ provider: 'http://localhost:8545', address: 'some-user-id', privateKey: 'some-user-priv-key'})
```

### setAccount

Set the ethereum address what will be used to sign all transactions

**Parameters**

-   `address` **[String][60]** address of the operator/user
-   `privateKey` **[String][60]** optional - private key of the operator/user

**Examples**

```javascript
paratii.setAccount('some-user-id','some-user-pub-key')
```

### setRegistryAddress

Set the address of the ParatiiRegistry contract

**Parameters**

-   `address` **[String][60]** address of the ParatiiRegistry contract

**Examples**

```javascript
paratii.setRegistryAddress('some-address')
```

### diagnose

return an array of strings with diagnostic info

**Examples**

```javascript
paratii.diagnose()
```

Returns **[Promise][59]** array of strings with diagnostic info

[1]: #paratiicore

[2]: #paratiicoreusers

[3]: #create

[4]: #get

[5]: #update

[6]: #paratiicorevids

[7]: #like

[8]: #dislike

[9]: #doeslike

[10]: #hasviewedvideo

[11]: #doesdislike

[12]: #create-1

[13]: #update-1

[14]: #upsert

[15]: #view

[16]: #get-1

[17]: #search

[18]: #paratiidb

[19]: #paratiidbusers

[20]: #get-2

[21]: #videos

[22]: #paratiidbvids

[23]: #get-3

[24]: #search-1

[25]: #constructor

[26]: #gettcrcontract

[27]: #getmindeposit

[28]: #iswhitelisted

[29]: #didvideoapply

[30]: #apply

[31]: #checkeligiblityandapply

[32]: #paratiiethusers

[33]: #paratiiipfs

[34]: #add

[35]: #get-4

[36]: #log

[37]: #warn

[38]: #error

[39]: #getipfsinstance

[40]: #addjson

[41]: #addandpinjson

[42]: #getjson

[43]: #start

[44]: #stop

[45]: #uploader

[46]: #add-1

[47]: #html5filetopull

[48]: #fsfiletopull

[49]: #upload

[50]: #adddirectory

[51]: #transcode

[52]: #_transcoderresphander

[53]: #addandtranscode

[54]: #paratii

[55]: #setaccount

[56]: #setregistryaddress

[57]: #diagnose

[58]: https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object

[59]: https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Promise

[60]: https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String

[61]: https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Boolean

[62]: https://developer.mozilla.org/docs/Web/JavaScript/Reference/Statements/function

[63]: https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Array

[64]: https://github.com/Paratii-Video/paratii-lib/blob/master/docs/paratii-ipfs.md#ipfsuploadertranscodefilehash-options
