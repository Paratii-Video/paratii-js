yarn run v1.3.2
$ /root/vouchers/paratii-lib/node_modules/.bin/mocha --require babel.js --exit --timeout 10000 test/paratii.eth.vouchers.js


  paratii.eth.vouchers:
_________+DIAG
ParatiiToken.transfer
beneficiary 0xf26190E98eFFf808eF4a7DAFFAB9BBE1415Ecc6d
amount 2000000000000000000
voucherBalanceBefore 0
voucherBalance 2000000000000000000
{ blockHash: '0x4667d3de477965a17cfb83c1a0a3c4e6eca3ab4152e762c95ee2a72ac7d2ed50',
  blockNumber: 11743,
  contractAddress: null,
  cumulativeGasUsed: 51861,
  gasUsed: 51861,
  logsBloom: '0x00000000000000000000000000000000000000000000000000000000000000000400080000000000000000000000000000000000000000000040000000080000400000000000000000000008000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000010000100000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000000000000000000000000040002000000000000010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000',
  root: null,
  status: null,
  transactionHash: '0x6d3d7e61ffbb0411dff128ceef6e4d69158fa9bc862d587ad22c28e3c99d94eb',
  transactionIndex: 0,
  events: 
   { Transfer: 
      { address: '0x079Fa972294eBc837DF47a202a8ed89C3591782B',
        blockHash: '0x4667d3de477965a17cfb83c1a0a3c4e6eca3ab4152e762c95ee2a72ac7d2ed50',
        blockNumber: 11743,
        logIndex: 0,
        transactionHash: '0x6d3d7e61ffbb0411dff128ceef6e4d69158fa9bc862d587ad22c28e3c99d94eb',
        transactionIndex: 0,
        transactionLogIndex: '0x0',
        type: 'mined',
        id: 'log_c4d1fc51',
        returnValues: [Result],
        event: 'Transfer',
        signature: '0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef',
        raw: [Object] } } }
_________
    ✓ vouchers.create() should work as expected
_________+DIAG
ParatiiToken.transfer
beneficiary 0xe05EFD114929792D16128321444EB885a90F572E
amount 2000000000000000000
voucherBalanceBefore 0
voucherBalance 2000000000000000000
{ blockHash: '0xff1eaf69ec99d2a5449d41f492adf1b9d652f64de22cc69d15372750f89cf788',
  blockNumber: 11762,
  contractAddress: null,
  cumulativeGasUsed: 51861,
  gasUsed: 51861,
  logsBloom: '0x00000000000000000000000000000000000000000000000000000000000000000400000000000000000000000000000000000000000000000000000000080000000000000000000000000008000000000800000000000000000000000000008000000000000000000000000000000000100000000000002000000010000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000040002000000000000000000000000000000000400000000000000000000000000000000000000000000000000000000000000000000000000000000000000',
  root: null,
  status: null,
  transactionHash: '0x4c778e703d80b9d01e41ff193aafbb3ba04943a468ae73ef5290125df47a9412',
  transactionIndex: 0,
  events: 
   { Transfer: 
      { address: '0x1C02947728757c88d3a7A24C3E29a7D5170DB352',
        blockHash: '0xff1eaf69ec99d2a5449d41f492adf1b9d652f64de22cc69d15372750f89cf788',
        blockNumber: 11762,
        logIndex: 0,
        transactionHash: '0x4c778e703d80b9d01e41ff193aafbb3ba04943a468ae73ef5290125df47a9412',
        transactionIndex: 0,
        transactionLogIndex: '0x0',
        type: 'mined',
        id: 'log_c89a1146',
        returnValues: [Result],
        event: 'Transfer',
        signature: '0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef',
        raw: [Object] } } }
_________
{ blockHash: '0x356e115bfc6be7e8c1a03c665a88ec0f861169ab94561aa2fd802f25466a5c5a',
  blockNumber: 11764,
  contractAddress: null,
  cumulativeGasUsed: 65568,
  gasUsed: 65568,
  logsBloom: '0x00000000000000000000000000000000000000000000000000000000000000000400000000000000400000000000000000000000000000000000000000080000000000000000000000000008000000000800000000000000000000000000008000000000000000000000000000000000100000000000002000000010000000000000000000000000000000002000000000000000010000010000000000000000000000000000000000000008400000000000000000000000000000000000000000040002000000000000000000000000800000000400000000000000000000000000000000000000000000000000000000000000000000000000000000000000',
  root: null,
  status: null,
  transactionHash: '0x33d77d2d5df267afa7212ac65bad19037afb7443221807f56e9e4e0d43a6d269',
  transactionIndex: 0,
  events: 
   { '0': 
      { address: '0x1C02947728757c88d3a7A24C3E29a7D5170DB352',
        blockHash: '0x356e115bfc6be7e8c1a03c665a88ec0f861169ab94561aa2fd802f25466a5c5a',
        blockNumber: 11764,
        logIndex: 0,
        transactionHash: '0x33d77d2d5df267afa7212ac65bad19037afb7443221807f56e9e4e0d43a6d269',
        transactionIndex: 0,
        transactionLogIndex: '0x0',
        type: 'mined',
        id: 'log_32ec0fb8',
        returnValues: Result {},
        event: undefined,
        signature: null,
        raw: [Object] },
     LogRedeemVoucher: 
      { address: '0xe05EFD114929792D16128321444EB885a90F572E',
        blockHash: '0x356e115bfc6be7e8c1a03c665a88ec0f861169ab94561aa2fd802f25466a5c5a',
        blockNumber: 11764,
        logIndex: 1,
        transactionHash: '0x33d77d2d5df267afa7212ac65bad19037afb7443221807f56e9e4e0d43a6d269',
        transactionIndex: 0,
        transactionLogIndex: '0x1',
        type: 'mined',
        id: 'log_47425f89',
        returnValues: [Result],
        event: 'LogRedeemVoucher',
        signature: '0x2eaff7d7b1644e86930213c456e12bfdad67722d421620a44206c51cc0820939',
        raw: [Object] } } }
0x9e2d04eef5b16CFfB4328Ddd027B55736407B275
    ✓ vouchers.redeem() should work as expected (46ms)
_________+DIAG
ParatiiToken.transfer
beneficiary 0xe15dDD9d771519107393Fb499009D2D0b77Fc807
amount 2000000000000000000
voucherBalanceBefore 0
voucherBalance 2000000000000000000
{ blockHash: '0x5a7d125daa4c417e5eeb3bf23514af0a97c17daa0b3b0d4af1091760be276249',
  blockNumber: 11782,
  contractAddress: null,
  cumulativeGasUsed: 51861,
  gasUsed: 51861,
  logsBloom: '0x40000000000000000000000000000000000000000000000000000000000000800400000000000000000000000000000000000000000000000000000000080000000000000000000000000008000000000001000000000000000020000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000040002000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000040000000000000000000000800000',
  root: null,
  status: null,
  transactionHash: '0x576d6cfec1f77287b8e78c8f7a89da31ecde710dc35ed18d70fd811169cd50a0',
  transactionIndex: 0,
  events: 
   { Transfer: 
      { address: '0xB656f66F5e13A4442b752f1155a9CA6bE6DeC465',
        blockHash: '0x5a7d125daa4c417e5eeb3bf23514af0a97c17daa0b3b0d4af1091760be276249',
        blockNumber: 11782,
        logIndex: 0,
        transactionHash: '0x576d6cfec1f77287b8e78c8f7a89da31ecde710dc35ed18d70fd811169cd50a0',
        transactionIndex: 0,
        transactionLogIndex: '0x0',
        type: 'mined',
        id: 'log_ec8d6456',
        returnValues: [Result],
        event: 'Transfer',
        signature: '0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef',
        raw: [Object] } } }
_________
{ blockHash: '0x2130ca06f1eccd091be8eb51fe3624841e6591e2585800787475030b20ab1fe5',
  blockNumber: 11784,
  contractAddress: null,
  cumulativeGasUsed: 65568,
  gasUsed: 65568,
  logsBloom: '0x40000000000000000000000000000000000000000000000000000000000000800400000000000000000000000000000000000000000000000000000000080000000000000000000000000008000000000001000000000000000020000000000000000000000000000000000000000000000000000000000000100010000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000400000000000000000020000000000000000000000040002000000080000000000000000800000000000000000000000000000000000000000000000000000000000000000040000000000000000000000800000',
  root: null,
  status: null,
  transactionHash: '0x3416db0ddbc56494123d0d4619e9b091c2bbf1861ec1187ef7013f5189038b90',
  transactionIndex: 0,
  events: 
   { '0': 
      { address: '0xB656f66F5e13A4442b752f1155a9CA6bE6DeC465',
        blockHash: '0x2130ca06f1eccd091be8eb51fe3624841e6591e2585800787475030b20ab1fe5',
        blockNumber: 11784,
        logIndex: 0,
        transactionHash: '0x3416db0ddbc56494123d0d4619e9b091c2bbf1861ec1187ef7013f5189038b90',
        transactionIndex: 0,
        transactionLogIndex: '0x0',
        type: 'mined',
        id: 'log_302ba740',
        returnValues: Result {},
        event: undefined,
        signature: null,
        raw: [Object] },
     LogRedeemVoucher: 
      { address: '0xe15dDD9d771519107393Fb499009D2D0b77Fc807',
        blockHash: '0x2130ca06f1eccd091be8eb51fe3624841e6591e2585800787475030b20ab1fe5',
        blockNumber: 11784,
        logIndex: 1,
        transactionHash: '0x3416db0ddbc56494123d0d4619e9b091c2bbf1861ec1187ef7013f5189038b90',
        transactionIndex: 0,
        transactionLogIndex: '0x1',
        type: 'mined',
        id: 'log_569c9249',
        returnValues: [Result],
        event: 'LogRedeemVoucher',
        signature: '0x2eaff7d7b1644e86930213c456e12bfdad67722d421620a44206c51cc0820939',
        raw: [Object] } } }
0x9e2d04eef5b16CFfB4328Ddd027B55736407B275
    1) vouchers.redeem() should fail on used code
_________+DIAG
ParatiiToken.transfer
beneficiary 0xdde50bAa976d503F0D29F5f3e507C5485C4e1681
amount 2000000000000000000
voucherBalanceBefore 0
voucherBalance 2000000000000000000
{ blockHash: '0x74478bf6c63c9940953279da62f3cd5db80aa73ae647c7950009a4f4127c7101',
  blockNumber: 11802,
  contractAddress: null,
  cumulativeGasUsed: 51861,
  gasUsed: 51861,
  logsBloom: '0x00000000000000000000000000000000000000000000000000000000000000000400000000000000000000000000000000000000000000000000000080080000000000000000000000000008000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000044002000000000000002000000000000000000000000000000000000008400000000000000000000000000000000000000000002000000000000000000000',
  root: null,
  status: null,
  transactionHash: '0xbe272e2f58d542ef07169e84617c4434a5f51a8a3654d1c74d32b341502a1443',
  transactionIndex: 0,
  events: 
   { Transfer: 
      { address: '0x923e63374b5bC9A3e6b3669D2cE5ced56De18aDd',
        blockHash: '0x74478bf6c63c9940953279da62f3cd5db80aa73ae647c7950009a4f4127c7101',
        blockNumber: 11802,
        logIndex: 0,
        transactionHash: '0xbe272e2f58d542ef07169e84617c4434a5f51a8a3654d1c74d32b341502a1443',
        transactionIndex: 0,
        transactionLogIndex: '0x0',
        type: 'mined',
        id: 'log_8ace80f9',
        returnValues: [Result],
        event: 'Transfer',
        signature: '0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef',
        raw: [Object] } } }
_________
    2) vouchers.create() should fail on invalid data
    - vouchers.create() should throw meaningful errors on failure


  2 passing (2s)
  1 pending
  2 failing

  1) paratii.eth.vouchers:
       vouchers.redeem() should fail on used code:
     Error: This voucher was already used
      at ParatiiEthVouchers.redeem$ (lib/paratii.eth.vouchers.js:67:14)
      at tryCatch (node_modules/babel-runtime/node_modules/regenerator-runtime/runtime.js:62:40)
      at Generator.invoke [as _invoke] (node_modules/babel-runtime/node_modules/regenerator-runtime/runtime.js:296:22)
      at Generator.prototype.(anonymous function) [as next] (node_modules/babel-runtime/node_modules/regenerator-runtime/runtime.js:114:21)
      at tryCatch (node_modules/babel-runtime/node_modules/regenerator-runtime/runtime.js:62:40)
      at invoke (node_modules/babel-runtime/node_modules/regenerator-runtime/runtime.js:152:20)
      at node_modules/babel-runtime/node_modules/regenerator-runtime/runtime.js:162:13
      at <anonymous>

  2) paratii.eth.vouchers:
       vouchers.create() should fail on invalid data:
     Error: Voucher Code argument must not be null
      at ParatiiEthVouchers.create$ (lib/paratii.eth.vouchers.js:27:13)
      at tryCatch (node_modules/babel-runtime/node_modules/regenerator-runtime/runtime.js:62:40)
      at Generator.invoke [as _invoke] (node_modules/babel-runtime/node_modules/regenerator-runtime/runtime.js:296:22)
      at Generator.prototype.(anonymous function) [as next] (node_modules/babel-runtime/node_modules/regenerator-runtime/runtime.js:114:21)
      at tryCatch (node_modules/babel-runtime/node_modules/regenerator-runtime/runtime.js:62:40)
      at invoke (node_modules/babel-runtime/node_modules/regenerator-runtime/runtime.js:152:20)
      at node_modules/babel-runtime/node_modules/regenerator-runtime/runtime.js:195:11
      at new Promise (<anonymous>)
      at callInvokeWithMethodAndArg (node_modules/babel-runtime/node_modules/regenerator-runtime/runtime.js:194:16)
      at AsyncIterator.enqueue (node_modules/babel-runtime/node_modules/regenerator-runtime/runtime.js:217:13)
      at AsyncIterator.prototype.(anonymous function) [as next] (node_modules/babel-runtime/node_modules/regenerator-runtime/runtime.js:114:21)
      at Object.runtime.async (node_modules/babel-runtime/node_modules/regenerator-runtime/runtime.js:241:14)
      at ParatiiEthVouchers.create (lib/paratii.eth.vouchers.js:70:36)
      at Context._callee5$ (test/paratii.eth.vouchers.js:47:50)
      at tryCatch (node_modules/babel-runtime/node_modules/regenerator-runtime/runtime.js:62:40)
      at Generator.invoke [as _invoke] (node_modules/babel-runtime/node_modules/regenerator-runtime/runtime.js:296:22)
      at Generator.prototype.(anonymous function) [as next] (node_modules/babel-runtime/node_modules/regenerator-runtime/runtime.js:114:21)
      at tryCatch (node_modules/babel-runtime/node_modules/regenerator-runtime/runtime.js:62:40)
      at invoke (node_modules/babel-runtime/node_modules/regenerator-runtime/runtime.js:152:20)
      at node_modules/babel-runtime/node_modules/regenerator-runtime/runtime.js:195:11
      at new Promise (<anonymous>)
      at callInvokeWithMethodAndArg (node_modules/babel-runtime/node_modules/regenerator-runtime/runtime.js:194:16)
      at AsyncIterator.enqueue (node_modules/babel-runtime/node_modules/regenerator-runtime/runtime.js:217:13)
      at AsyncIterator.prototype.(anonymous function) [as next] (node_modules/babel-runtime/node_modules/regenerator-runtime/runtime.js:114:21)
      at Object.runtime.async (node_modules/babel-runtime/node_modules/regenerator-runtime/runtime.js:241:14)
      at Context._callee5 (test/paratii.eth.vouchers.js:46:55)
      at <anonymous>



info Visit https://yarnpkg.com/en/docs/cli/run for documentation about this command.
